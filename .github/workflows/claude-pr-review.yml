name: Claude Issue Response

on:
  issues:
    types: [opened, edited]
  issue_comment:
    types: [created]

permissions:
  issues: write
  contents: read

jobs:
  respond-to-mention:
    runs-on: ubuntu-latest
    if: |
      contains(github.event.issue.body, '@claude') ||
      contains(github.event.comment.body, '@claude')
    
    steps:
      - name: Analyze and Respond
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const issue = context.payload.issue;
            const comment = context.payload.comment;
            const content = comment ? comment.body : issue.body;
            const lowerContent = content.toLowerCase();
            
            let response;
            
            if (lowerContent.includes('state')) {
              response = `üîç State Management Analysis:

1. Component state handlers:
   - useState for toggle state
   - useEffect for side effects
   - Context for shared state

2. Event handling:
   - onClick handlers
   - onChange events
   - Custom events

3. Props management:
   - TypeScript interfaces
   - Default values
   - Prop validation

Would you like me to focus on any specific aspect?`;
            } else {
              response = `üëã I can help analyze your toggle button implementation. Please specify what you'd like me to check:

1. "@claude check state" - Analyze state management
2. "@claude check events" - Review event handling
3. "@claude check ui" - Examine UI/UX
4. "@claude check accessibility" - Verify accessibility

Let me know which aspect you'd like me to examine!`;
            }
            
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issue.number,
              body: response
            });